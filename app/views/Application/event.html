#{extends 'main.html' /}
#{set title:'www.java.no' /}

<div class="grid_8">
<h1>${event?.title}</h1>
<p>${event?.date?.format("dd.MM.yyyy")} på ${event?.location}</p>
<br/>
<p>${event?.description}</p>
<br/>
<p>${event?.extraInfo?.raw()}</p>
<br/>
<p>#{if new Date().before(event?.date?.plus(1))}<a href="javascript:" onclick="$('#registrering').dialog({
			    modal: true,
			    width : 420,
			    buttons: {
                    'Meld meg på!': function() {
                        $.post('@{signUpForEvent()}', {eventId : $('#eventId').val(), randomId : $('#randomId').val(), code : $('#code').val(), name:  $('#name').val(), email: $('#email').val(), howMany: $('#howMany').val()}, function(data){
                            if(data['errors'].length > 0){
                                for(var i = 0; i < data['errors'].length; i++){
                                    $('#' + data['errors'][i].key).addClass( 'ui-state-error' );
                                }
                            } else {
                              $('#registrering').dialog( 'close' );
                            }
                        });

                    }
				}
		        });$('#eventId').val(${event?.id});$('#eventTitle').html('${event?.region?.realName} : ${event?.title}');"><img style="vertical-align:middle" src="/public/images/add.png" alt="meld meg på!"/></a>
    <a href="@{Application.ical(event?.id)}"><img src="/public/images/ical.png" class="map" alt="kalender"/></a>
    <a href="@{Application.pdf(event?.id)}"><img src="/public/images/pdf.png" class="map" alt="få den i pdf og skriv den ut"/></a>
    #{/if}
    #{if new Date().after(event?.date)}
    <a href="javascript:" onclick="$('#kommer').dialog({modal: true});"><img src="/public/images/slides.png" class="map" alt="slides fra foreleser"/></a>
    #{/if}
    <a  href="javascript:" onclick="$('#kart').html('${event?.location}, ${event?.address}<br/><img src=\&quot;http://maps.google.com/maps/api/staticmap?center=${event?.address}&zoom=14&size=590x540&maptype=roadmap&markers=color:yellow%7C${event?.address}&sensor=false\&quot; alt=\&quot;Her skal vi møtes!\&quot;/>');
    $('#kart').dialog({
            modal: true,
            resizable: false,
            width : 625,
            height : 625
            });">
        <img src="/public/images/map.png" alt="kart" class="map"/>
    </a>
    <a href="http://twitter.com/share?text=%23javaBin%20ftw!&url=http%3A%2F%2Fjava.no/event/${event?.id}"><img class="map" src="/public/images/twitter_3.png" alt="Del møtet på twitter"></a>
</p>
<br/>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'javabin'; // required: replace example with your forum shortname
    // The following are highly recommended additional parameters. Remove the slashes in front to use.
    var disqus_identifier = ${event?.id};
    var disqus_url = 'http://www.java.no/event/${event?.id}';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">Kommentarer leveres av Disqus.</a></noscript>
<a href="http://disqus.com">Kommentarer leveres av <span class="logo-disqus">Disqus</span></a>


</div>
<div class="grid_4">
<b>Foredragsholder(e):</b><br/><br/>
    #{list items:event?.lectureholders, as:'lectureholder'}
    <div style="width:120px" class="grid_2">
       <img src="http://www.gravatar.com/avatar/${lectureholder?.gravatarhash(lectureholder?.gravatarId)}?s=100&d=monsterid"/>
        <br/>
        ${lectureholder?.fullName}<br/>
    </div>
    #{/list}
<div class="clear"></div>
    <br/><b>Påmeldte så langt:</b><br/><br/>
               #{if event?.participants?.size() == 0}
                Det er ennå ingen påmeldte deltagere. <br/>Sjekk senere :)
                #{/if}
                #{list items:event?.participants, as:'participant'}
                 <div class="grid_1">
                <img src="http://www.gravatar.com/avatar/${models.LectureHolder.gravatarhash(participant?.email).raw()}?s=60&d=monsterid"/><br/>
                ${participant.name}
                </div>
               #{if participant_index % 3 == 0}
                <div class="clear"></div>
                #{/if}

              #{/list}


</div>

<div style="display:none" id="registrering" title="Påmelding til møte">
    <br/>
    <p id="eventTitle"></p>
    <br/>

    <table border="0" cellspacing="5" cellpadding="5">
        <tr>
            <td class="label">Navn</td>
            <td class="input" ><input type="text" name="name" id="name"/></td>
        </tr>
        <tr>
            <td class="label">&nbsp;</td>
            <td class="input"><span class="infotxt">Kjekt for oss å vite hva du heter.</span></td>
        </tr>
        <tr>
            <td class="label">E-post</td>
            <td class="input"><input type="text" name="email" id="email"/></td>
        </tr>
        <tr>
            <td class="label">&nbsp;</td>
            <td class="input"><span class="infotxt">Bekreftelse sendes til deg på mail.</span></td>
        </tr>
        <tr>
            <td class="label">Antall</td>
            <td class="input">#{select 'howMany', size:1, id:'howMany', items:1..3/}</td>
        </tr>
        <tr>
            <td class="label">&nbsp;</td>
            <td class="input"><span class="infotxt">Hvor mange melder du på?</span></td>
        </tr>
        <tr>
            <td colspan="2">&nbsp;</td>
        </tr>
        <tr>
            <td colspan="2"><hr/></td>
        </tr>
        <tr>
            <td class="label">&nbsp;</td>
            <td class="input"><img src="@{Application.captcha(randomId)}" /><input type="hidden" name="randomId" value="${randomId}" /></td>
        </tr>
        <tr>
            <td class="label">Gjenta koden</td>
            <td class="input"><input type="text" name="code" id="code" value="" /></td>
        </tr>

    </table>
</div>


        <div id="kart" style="display:none" title="Her skal vi møtes"></div>

            <div id="kommer" style="display:none" title="Her kommer det noe snart.">
                <p>Vi jobber med det</p>
            </div>

            <input type="hidden" id="randomId" name="randomId" value="${randomId}" />
        	<input type="hidden" id="eventId" value=""/>